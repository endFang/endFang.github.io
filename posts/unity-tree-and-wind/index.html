<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Tree And Wind Shader | After1995</title>
<meta name=keywords content="Shader,Unity">
<meta name=description content="Vertex Color, Alpha and Shadow Surface shader is actually a vertex and fragment shader too, so theoretically the vertex data is accessible in surface shader too by using SEMANTICS or common state vert
struct v2f { half4 color : COLOR; }; As for the Alpha Texture, we can decide the color based on the UV mapping in vertex function
fixed4 frag (v2f i) : COLOR0 { ... fixed alpha = tex2D (_AlphaTex, i.">
<meta name=author content="Kyle Fang">
<link rel=canonical href=https://endfang.github.io/posts/unity-tree-and-wind/>
<meta name=google-site-verification content="XYZabc">
<meta name=yandex-verification content="XYZabc">
<meta name=msvalidate.01 content="XYZabc">
<link crossorigin=anonymous href=/assets/css/stylesheet.min.9f1d947375927e9847272b1f4e9be81336f539e513bf04d52cade31f81cad1af.css integrity="sha256-nx2Uc3WSfphHJysfTpvoEzb1OeUTvwTVLK3jH4HK0a8=" rel="preload stylesheet" as=style>
<link rel=preload href=/apple-touch-icon.png as=image>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://endfang.github.io/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://endfang.github.io/favicon-16x16.ico>
<link rel=icon type=image/png sizes=32x32 href=https://endfang.github.io/favicon-32x32.ico>
<link rel=apple-touch-icon href=https://endfang.github.io/apple-touch-icon.png>
<link rel=mask-icon href=https://endfang.github.io/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.88.1">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript><meta property="og:title" content="Tree And Wind Shader">
<meta property="og:description" content="Vertex Color, Alpha and Shadow Surface shader is actually a vertex and fragment shader too, so theoretically the vertex data is accessible in surface shader too by using SEMANTICS or common state vert
struct v2f { half4 color : COLOR; }; As for the Alpha Texture, we can decide the color based on the UV mapping in vertex function
fixed4 frag (v2f i) : COLOR0 { ... fixed alpha = tex2D (_AlphaTex, i.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://endfang.github.io/posts/unity-tree-and-wind/"><meta property="og:image" content="https://endfang.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2020-10-23T11:26:50+08:00">
<meta property="article:modified_time" content="2020-10-23T11:26:50+08:00"><meta property="og:site_name" content="After1995">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://endfang.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E">
<meta name=twitter:title content="Tree And Wind Shader">
<meta name=twitter:description content="Vertex Color, Alpha and Shadow Surface shader is actually a vertex and fragment shader too, so theoretically the vertex data is accessible in surface shader too by using SEMANTICS or common state vert
struct v2f { half4 color : COLOR; }; As for the Alpha Texture, we can decide the color based on the UV mapping in vertex function
fixed4 frag (v2f i) : COLOR0 { ... fixed alpha = tex2D (_AlphaTex, i.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://endfang.github.io/posts/"},{"@type":"ListItem","position":3,"name":"Tree And Wind Shader","item":"https://endfang.github.io/posts/unity-tree-and-wind/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Tree And Wind Shader","name":"Tree And Wind Shader","description":"Vertex Color, Alpha and Shadow Surface shader is actually a vertex and fragment shader too, so theoretically the vertex data is accessible in surface shader too by using SEMANTICS or common state vert\nstruct v2f { half4 color : COLOR; }; As for the Alpha Texture, we can decide the color based on the UV mapping in vertex function\nfixed4 frag (v2f i) : COLOR0 { ... fixed alpha = tex2D (_AlphaTex, i.","keywords":["Shader","Unity"],"articleBody":"Vertex Color, Alpha and Shadow Surface shader is actually a vertex and fragment shader too, so theoretically the vertex data is accessible in surface shader too by using SEMANTICS or common state vert\nstruct v2f { half4 color : COLOR; }; As for the Alpha Texture, we can decide the color based on the UV mapping in vertex function\nfixed4 frag (v2f i) : COLOR0 { ... fixed alpha = tex2D (_AlphaTex, i.uv).r; tex.a = alpha; ... } Surface shader does not generate a shadow-cast pass, so the pass in the fallback is used. To add shadow, we can use addshadow and another SubSahder tagged \"ShadowCaster\".\nCull Off makes sure the plane will show both side.\n_CutOff is a property.\nSubShader { Tags { \"LightMode\" = \"ShadowCaster\" } Cull Off Pass { CGPROGRAM #pragma vertex vert #pragma fragment frag ... fixed4 frag (v2f i) : COLOR0 { fixed4 tex = tex2D (_MainTex, i.uv); fixed alpha = tex2D (_AlphaTex, i.uv).r; tex.a = alpha; clip(tex.a - _Cutoff); return(alpha); } ... ENDCG } } This is actually a clumsy solution, because it violates the DRY principle by repeating the same calculation in the shadow part, but I haven’t learned enough yet to find a better solution.\nWind Vertex function can update the vertex data and change the placement. We use the _Time variable to add animation by calculating the displacement based on the all wind parameters.\nHowever, I didn’t find a good enough mathematical or physical model for the wind. The code will get improved if I can find solution to reduce the cluster of calculation.\nProperties { _wind_dir (\"Wind Direction\", Vector) = (0.5,0.05,0.5,0) _wind_size (\"Wind Wave Size\", range(1,50)) = 15 _tree_sway_stutter_influence(\"Tree Sway Stutter Influence\", range(0,1)) = 0.2 _tree_sway_stutter (\"Tree Sway Stutter\", range(0,10)) = 1.5 _tree_sway_speed (\"Tree Sway Speed\", range(0,10)) = 1 _tree_sway_disp (\"Tree Sway Displacement\", range(0,1)) = 0.3 } //Gets the vertex's World Position  float3 worldPos = mul (unity_ObjectToWorld, v.vertex).xyz; //Tree Movement and Wiggle v.vertex.x += (cos(_Time.z * _tree_sway_speed + (worldPos.x/_wind_size) + (sin(_Time.z * _tree_sway_stutter * _tree_sway_speed + (worldPos.x/_wind_size)) * _tree_sway_stutter_influence) ) + 1)/2 * _tree_sway_disp * _wind_dir.x * (v.vertex.y / 10) + cos(_Time.w * v.vertex.x * 0.01 + (worldPos.x/_wind_size)) * 0.07 * _wind_dir.x * v.color.b; v.vertex.z += (cos(_Time.z * _tree_sway_speed + (worldPos.z/_wind_size) + (sin(_Time.z * _tree_sway_stutter * _tree_sway_speed + (worldPos.z/_wind_size)) * _tree_sway_stutter_influence) ) + 1)/2 * _tree_sway_disp * _wind_dir.z * (v.vertex.y / 10) + cos(_Time.w * v.vertex.z * 0.01 + (worldPos.x/_wind_size)) * 0.07 * _wind_dir.z * v.color.b; v.vertex.y += cos(_Time.z * _tree_sway_speed + (worldPos.z/_wind_size)) * _tree_sway_disp * _wind_dir.y * (v.vertex.y / 10); ","wordCount":"421","inLanguage":"en","datePublished":"2020-10-23T11:26:50+08:00","dateModified":"2020-10-23T11:26:50+08:00","author":{"@type":"Person","name":"Kyle Fang"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://endfang.github.io/posts/unity-tree-and-wind/"},"publisher":{"@type":"Organization","name":"After1995","logo":{"@type":"ImageObject","url":"https://endfang.github.io/favicon.ico"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://endfang.github.io accesskey=h title="After1995 (Alt + H)">
<img src=/apple-touch-icon.png alt=logo aria-label=logo height=35>After1995</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://endfang.github.io/archives/ title=archives>
<span>archives</span>
</a>
</li>
<li>
<a href=https://endfang.github.io/categories/ title=categories>
<span>categories</span>
</a>
</li>
<li>
<a href=https://endfang.github.io/tags/ title=tags>
<span>tags</span>
</a>
</li>
<li>
<a href=https://endfang.github.io/about/ title=about>
<span>about</span>
</a>
</li>
<li>
<a href=https://endfang.github.io/search/ title="search (Alt + /)" accesskey=/>
<span>search</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=https://endfang.github.io>Home</a>&nbsp;»&nbsp;<a href=https://endfang.github.io/posts/>Posts</a></div>
<h1 class=post-title>
Tree And Wind Shader
</h1>
<div class=post-meta>October 23, 2020&nbsp;·&nbsp;Kyle Fang
</div>
</header> <div class=toc>
<details open>
<summary accesskey=c title="(Alt + C)">
<span class=details>Table of Contents</span>
</summary>
<div class=inner><ul>
<li>
<a href=#vertex-color-alpha-and-shadow aria-label="Vertex Color, Alpha and Shadow">Vertex Color, Alpha and Shadow</a></li>
<li>
<a href=#wind aria-label=Wind>Wind</a>
</li>
</ul>
</div>
</details>
</div>
<div class=post-content><h1 id=vertex-color-alpha-and-shadow>Vertex Color, Alpha and Shadow<a hidden class=anchor aria-hidden=true href=#vertex-color-alpha-and-shadow>#</a></h1>
<p>Surface shader is actually a vertex and fragment shader too, so theoretically the vertex data is accessible in surface shader too by using <code>SEMANTICS</code> or common state <code>vert</code></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-glsl data-lang=glsl><span style=color:#66d9ef>struct</span> v2f
{
	half4 color <span style=color:#f92672>:</span> COLOR;
};
</code></pre></div><p>As for the Alpha Texture, we can decide the color based on the UV mapping in vertex function</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-glsl data-lang=glsl>fixed4 frag (v2f i) <span style=color:#f92672>:</span> COLOR0 
{
	...

	<span style=color:#66d9ef>fixed</span> alpha <span style=color:#f92672>=</span> tex2D (_AlphaTex, i.uv).r;
	tex.a <span style=color:#f92672>=</span> alpha;
	
	...
}
</code></pre></div><p>Surface shader does not generate a shadow-cast pass, so the pass in the fallback is used.
To add shadow, we can use <code>addshadow</code> and another SubSahder tagged <code>"ShadowCaster"</code>.</p>
<p><code>Cull Off</code> makes sure the plane will show both side.</p>
<p><code>_CutOff</code> is a property.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-glsl data-lang=glsl>SubShader
{
	Tags
	{
		<span style=color:#960050;background-color:#1e0010>&#34;</span>LightMode<span style=color:#960050;background-color:#1e0010>&#34;</span> <span style=color:#f92672>=</span> <span style=color:#960050;background-color:#1e0010>&#34;</span>ShadowCaster<span style=color:#960050;background-color:#1e0010>&#34;</span>
	}

	Cull Off
	
	Pass 
	{
		CGPROGRAM

		<span style=color:#960050;background-color:#1e0010>#</span>pragma vertex vert
		<span style=color:#960050;background-color:#1e0010>#</span>pragma fragment frag

		...

		fixed4 frag (v2f i) <span style=color:#f92672>:</span> COLOR0
		{
			fixed4 tex <span style=color:#f92672>=</span> tex2D (_MainTex, i.uv);
			<span style=color:#66d9ef>fixed</span> alpha <span style=color:#f92672>=</span> tex2D (_AlphaTex, i.uv).r;
			tex.a <span style=color:#f92672>=</span> alpha;
			clip(tex.a <span style=color:#f92672>-</span> _Cutoff);

			<span style=color:#66d9ef>return</span>(alpha);
		}
		
		...
		
		ENDCG
	}
}
</code></pre></div><p>This is actually a clumsy solution, because it violates the DRY principle by repeating the same calculation in the shadow part, but I haven&rsquo;t learned enough yet to find a better solution.</p>
<h1 id=wind>Wind<a hidden class=anchor aria-hidden=true href=#wind>#</a></h1>
<p>Vertex function can update the vertex data and change the placement.
We use the <code>_Time</code> variable to add animation by calculating the displacement based on the all wind parameters.</p>
<p>However, I didn&rsquo;t find a good enough mathematical or physical model for the wind. The code will get improved if I can find solution to reduce the cluster of calculation.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-glsl data-lang=glsl>Properties 
{
		_wind_dir (<span style=color:#960050;background-color:#1e0010>&#34;</span>Wind Direction<span style=color:#960050;background-color:#1e0010>&#34;</span>, Vector) <span style=color:#f92672>=</span> (<span style=color:#ae81ff>0.5</span>,<span style=color:#ae81ff>0.05</span>,<span style=color:#ae81ff>0.5</span>,<span style=color:#ae81ff>0</span>)
    _wind_size (<span style=color:#960050;background-color:#1e0010>&#34;</span>Wind Wave Size<span style=color:#960050;background-color:#1e0010>&#34;</span>, range(<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>50</span>)) <span style=color:#f92672>=</span> <span style=color:#ae81ff>15</span>

    _tree_sway_stutter_influence(<span style=color:#960050;background-color:#1e0010>&#34;</span>Tree Sway Stutter Influence<span style=color:#960050;background-color:#1e0010>&#34;</span>, range(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>1</span>)) <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.2</span>
    _tree_sway_stutter (<span style=color:#960050;background-color:#1e0010>&#34;</span>Tree Sway Stutter<span style=color:#960050;background-color:#1e0010>&#34;</span>, range(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>10</span>)) <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.5</span>
    _tree_sway_speed (<span style=color:#960050;background-color:#1e0010>&#34;</span>Tree Sway Speed<span style=color:#960050;background-color:#1e0010>&#34;</span>, range(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>10</span>)) <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
    _tree_sway_disp (<span style=color:#960050;background-color:#1e0010>&#34;</span>Tree Sway Displacement<span style=color:#960050;background-color:#1e0010>&#34;</span>, range(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>1</span>)) <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.3</span>
}
</code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-glsl data-lang=glsl><span style=color:#75715e>//Gets the vertex&#39;s World Position </span>
float3 worldPos <span style=color:#f92672>=</span> mul (unity_ObjectToWorld, v.vertex).xyz;

<span style=color:#75715e>//Tree Movement and Wiggle</span>
v.vertex.x <span style=color:#f92672>+=</span> (cos(_Time.z <span style=color:#f92672>*</span> _tree_sway_speed <span style=color:#f92672>+</span> (worldPos.x<span style=color:#f92672>/</span>_wind_size) <span style=color:#f92672>+</span> (sin(_Time.z <span style=color:#f92672>*</span> _tree_sway_stutter <span style=color:#f92672>*</span> _tree_sway_speed <span style=color:#f92672>+</span> (worldPos.x<span style=color:#f92672>/</span>_wind_size)) <span style=color:#f92672>*</span> _tree_sway_stutter_influence) ) <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)<span style=color:#f92672>/</span><span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> _tree_sway_disp <span style=color:#f92672>*</span> _wind_dir.x <span style=color:#f92672>*</span> (v.vertex.y <span style=color:#f92672>/</span> <span style=color:#ae81ff>10</span>) <span style=color:#f92672>+</span> 
cos(_Time.w <span style=color:#f92672>*</span> v.vertex.x <span style=color:#f92672>*</span> <span style=color:#ae81ff>0.01</span> <span style=color:#f92672>+</span> (worldPos.x<span style=color:#f92672>/</span>_wind_size)) <span style=color:#f92672>*</span> <span style=color:#ae81ff>0.07</span> <span style=color:#f92672>*</span> _wind_dir.x <span style=color:#f92672>*</span> v.color.b;

v.vertex.z <span style=color:#f92672>+=</span> (cos(_Time.z <span style=color:#f92672>*</span> _tree_sway_speed <span style=color:#f92672>+</span> (worldPos.z<span style=color:#f92672>/</span>_wind_size) <span style=color:#f92672>+</span> (sin(_Time.z <span style=color:#f92672>*</span> _tree_sway_stutter <span style=color:#f92672>*</span> _tree_sway_speed <span style=color:#f92672>+</span> (worldPos.z<span style=color:#f92672>/</span>_wind_size)) <span style=color:#f92672>*</span> _tree_sway_stutter_influence) ) <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)<span style=color:#f92672>/</span><span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> _tree_sway_disp <span style=color:#f92672>*</span> _wind_dir.z <span style=color:#f92672>*</span> (v.vertex.y <span style=color:#f92672>/</span> <span style=color:#ae81ff>10</span>) <span style=color:#f92672>+</span> 
cos(_Time.w <span style=color:#f92672>*</span> v.vertex.z <span style=color:#f92672>*</span> <span style=color:#ae81ff>0.01</span> <span style=color:#f92672>+</span> (worldPos.x<span style=color:#f92672>/</span>_wind_size)) <span style=color:#f92672>*</span> <span style=color:#ae81ff>0.07</span> <span style=color:#f92672>*</span> _wind_dir.z <span style=color:#f92672>*</span> v.color.b;

v.vertex.y <span style=color:#f92672>+=</span> cos(_Time.z <span style=color:#f92672>*</span> _tree_sway_speed <span style=color:#f92672>+</span> (worldPos.z<span style=color:#f92672>/</span>_wind_size)) <span style=color:#f92672>*</span> _tree_sway_disp <span style=color:#f92672>*</span> _wind_dir.y <span style=color:#f92672>*</span> (v.vertex.y <span style=color:#f92672>/</span> <span style=color:#ae81ff>10</span>);
</code></pre></div>
</div>
<footer class=post-footer>
<a rel=license href=http://creativecommons.org/licenses/by-nc/4.0/>
<img alt="Creative Commons License" style=border-width:0 src=https://i.creativecommons.org/l/by-nc/4.0/88x31.png>
</a><p style=font-size:small>This work is licensed under a <a rel=license href=http://creativecommons.org/licenses/by-nc/4.0/>Creative Commons Attribution-NonCommercial 4.0 International License</a>.</p>
<br>
<ul class=post-tags>
<li><a href=https://endfang.github.io/tags/shader/>Shader</a></li>
<li><a href=https://endfang.github.io/tags/unity/>Unity</a></li>
</ul>
<nav class=paginav>
<a class=prev href=https://endfang.github.io/posts/5-3grahatia/>
<span class=title>« Prev Page</span>
<br>
<span>5.3 中人人都爱 G'raha Tia</span>
</a>
<a class=next href=https://endfang.github.io/posts/where-5-2-is-leading-to/>
<span class=title>Next Page »</span>
<br>
<span>5.2开始铺路</span>
</a>
</nav>
</footer>
</article>
</main>
<footer class=footer>
<span>&copy; 2022 <a href=https://endfang.github.io>After1995</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>